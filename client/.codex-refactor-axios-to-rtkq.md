# Refactor Instructions

## Goal
Completely remove Axios from the codebase and replace it with Redux Toolkit Query (RTK Query) using `fetchBaseQuery`.

Each feature/module should have its own `ApiSlice` file for modularity and maintenance.

---

## General Rules

1. **Delete all Axios imports**
   - Remove `import axios from "axios";`
   - Replace all axios usages with RTK Query endpoints and hooks.

2. **Use the existing `apiSlice.js` as the base**
   - File: `/src/app/apiSlice.js`
   - Do not create multiple `createApi` roots.
   - Instead, use `apiSlice.injectEndpoints()` in separate feature-specific slices.

3. **For every axios call:**
   - Convert GET requests into `builder.query({...})`
   - Convert POST/PUT/PATCH/DELETE requests into `builder.mutation({...})`
   - Set `credentials: "include"` where cookies or sessions are used.
   - Use relative paths (e.g., `"api/reservation/confirmed"`) instead of full URLs.

4. **File organization**
   - `/src/app/apiSlice.js` → the base slice (already exists)
   - `/src/features/reservation/reservationApiSlice.js`
   - `/src/features/auth/authApiSlice.js`
   - `/src/features/lecturer/lecturerApiSlice.js`
   - `/src/features/slideshow/slideshowApiSlice.js`
   - Each feature slice should `import { apiSlice } from "../../app/apiSlice";`

5. **Endpoint naming convention**
   - `get*` for GET endpoints → `builder.query`
   - `create*`, `update*`, `delete*` for write operations → `builder.mutation`
   - Always export hooks using RTK Query conventions:
     ```js
     export const { useGetReservationQuery, useCreateReservationMutation } = reservationApiSlice;
     ```

6. **Replace component usage**
   - Example (axios → RTKQ):

     ```js
     // Before
     const response = await axios.get(`${backendUrl}/api/reservation/confirmed`);
     const confirmed = response.data.confirmed;

     // After
     const { data, isLoading, error } = useGetConfirmedReservationsQuery();
     const confirmed = data?.confirmed || [];
     ```

7. **Handle loading and error**
   - Replace manual `useEffect` fetches with RTK Query hook states (`isLoading`, `error`, `data`).

---

## Example Feature Slice

```js
// src/features/reservation/reservationApiSlice.js
import { apiSlice } from "../../app/apiSlice";

export const reservationApiSlice = apiSlice.injectEndpoints({
  endpoints: (builder) => ({
    getConfirmedReservations: builder.query({
      query: () => ({
        url: "api/reservation/confirmed",
        method: "GET",
        credentials: "include",
      }),
    }),
    createReservation: builder.mutation({
      query: (body) => ({
        url: "api/reservation",
        method: "POST",
        body,
        credentials: "include",
      }),
    }),
  }),
});

export const {
  useGetConfirmedReservationsQuery,
  useCreateReservationMutation,
} = reservationApiSlice;
